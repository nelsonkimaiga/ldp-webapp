<!DOCTYPE html>
<html lang="en" xml:lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Callback</title>
</head>

<body>
    <script>
        const params = new URLSearchParams(window.location.hash.substring(1));
        const accessToken = params.get("access_token");
        const refreshToken = params.get("refresh_token");
        const userId = params.get("userId");

        if (accessToken) {
            localStorage.setItem("access_token", accessToken);
            localStorage.setItem("refresh_token", refreshToken);
            localStorage.setItem("userId", userId);

            if (window.opener) {
                window.opener.postMessage({
                    accessToken,
                    refreshToken,
                    userId
                }, "*");
                window.close();
            } else {
                window.location.href = "profile.html";
            }
        } else {
            document.body.innerHTML = "<p>Login failed: No token found.</p>";
        }
    </script>

</body>

</html>