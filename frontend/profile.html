<!DOCTYPE html>
<html lang="en" xml:lang="en">

<head>
    <title>Profile</title>
</head>

<body>
    <h1>Profile</h1>
    <pre id="claims"></pre>

    <script src="https://cdn.jsdelivr.net/npm/jwt-decode/build/jwt-decode.min.js"></script>
    <script>
        const token = localStorage.getItem("id_token");
        if (!token) {
            window.location.href = "index.html";
        } else {
            const decoded = jwt_decode(token);
            document.getElementById("claims").innerText = JSON.stringify(decoded, null, 2);

            fetch("http://localhost:8080/api/v1/user", {
                    headers: {
                        "Authorization": "Bearer " + localStorage.getItem("access_token")
                    }
                })
                .then(r => r.json())
                .then(data => console.log("Backend response:", data))
                .catch(console.error);
        }
    </script>
</body>

</html>